---
title: "Data Manipulation"
author: "Sitruks"
date: "April 26, 2018"
output: html_document
editor_options: 
  chunk_output_type: console
---

### Data Wrangling Exercise 1:  

```{refine}
library(tidyverse)
library(forcats)
refine <- tbl_df(read_csv("Wrangle/1_Basic_Data_Manipulation/refine_original.csv"))
refine <- refine %>% 
           separate('Product code / number', into = c("product_code", "product_number")) %>% 
           mutate(companies = if_else(grepl("^p|^P|^f|^F", company), "philips",
                  if_else(grepl("^a|^A", company), "akzo",
                  if_else(grepl("^v|^V", company), "van houten",
                  if_else(grepl("^u|^U", company), "unilever",
                    "other")))),
                product_category = if_else(grepl("p", product_code), "smartphone",
                  if_else(grepl("v", product_code), "tv",
                  if_else(grepl("x", product_code), "laptop",
                  if_else(grepl("q", product_code), "tablet",
                    "other")))),
                full_address = paste(address, city, country, sep = ", "),
                company_philips = if_else(grepl("p", companies), 1 , 0),
                company_akzo = if_else(grepl("a", companies), 1, 0),
                company_van_houten = if_else(grepl("v", companies), 1, 0),
                company_unilever = if_else(grepl("u", companies), 1, 0),
                product_smartphone = if_else(grepl("p", product_code), 1, 0),
                product_tv = if_else(grepl("v", product_code), 1, 0),
                product_laptop = if_else(grepl("x", product_code), 1, 0),
                product_tablet = if_else(grepl("q", product_code), 1, 0)
                  ) %>% 
            select(-company) %>%
            select(companies, product_category, everything()) %>% 
            write_csv(refine, "Wrangle/1_Basic_Data_Manipulation/refine_clean.csv")

```
####Does not work
* rename(companies = company) %>% 
* attempt at using sub instead of grepl.  
`refine <- refine %>% sub(pattern = "^p\|^f", replacement = "philips", x = refine)
 `

          sub(pattern = "'ak zo'|akz0|akzo|Akzo|AKZO", replacement = "akzo", x = refine) %>% 
          sub(pattern = "'van houten'|'van Houten'|'Van Houten'", replacement = "van houten", x = refine) %>% 
          sub(pattern = "unilever|Unilever|unilver", replacement = "unilever", x = refine)  

####For Testing

company_distinct <- refine %>% group_by(company) %>% summarise(distinct = n_distinct(company)) %>% select(company) %>% c()