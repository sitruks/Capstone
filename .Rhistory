traffic_current_pie <- ggplot(new_users, aes(y = "This Week", fill = userType)) +
geom_bar(width = 1, stat = "identity")
traffic_current_pie
traffic_current_pie <- ggplot(new_users, aes(x =., y = "This Week", fill = userType)) +
geom_bar(width = 1, stat = "identity")
traffic_current_pie
traffic_current_pie <- ggplot(new_users, aes(x ="", y = "This Week", fill = userType)) +
geom_bar(width = 1, stat = "identity")
traffic_current_pie
traffic_current_pie <- ggplot(new_users, aes(x =1, y = "This Week", fill = userType)) +
geom_bar(width = 1, stat = "identity")
traffic_current_pie
traffic_current_pie <- ggplot(new_users, aes(x =1, y = "This Week", fill = userType)) +
geom_bar(width = 1, stat = "bin")
traffic_current_pie
traffic_current_pie <- ggplot(new_users, aes(x =1, y = "This Week", fill = userType)) +
geom_bar(width = 1, stat = "bin", position = "stack")
traffic_current_pie
traffic_current_pie <- ggplot(new_users, aes(x="", y = "This Week", fill = userType)) +
geom_bar(width = 1, stat = "bin", position = "stack")
traffic_current_pie
traffic_current_pie <- ggplot(new_users, aes(x="", y = "This Week", fill = userType)) +
geom_bar(width = 1, stat = "identity")
traffic_current_pie
twoweek_sessions
install.packages("plotly")
new_ret_users <- google_analytics(ga_id,
date_range = c("8daysAgo", "yesterday", "16daysAgo", "9daysAgo"),
metrics = c("sessions"),
dimensions = c("userType")) %>%
rename("This Week" = sessions.d1, "Last Week" = sessions.d2)
new_ret_users$userType <- as.factor(new_ret_users$userType)
new_users <- select(new_ret_users, userType,"This Week")
ret_users <- select(new_ret_users, userType,"Last Week")
new_ret_users
new_users
knitr::opts_chunk$set(echo = TRUE)
Packages <- c("googleAuthR", "googleAnalyticsR", "tidyverse")
lapply(Packages, library, character.only = TRUE)
ga_auth(".ga-httr-oauth")
ga_id <- 158889165
start_date <- "120daysAgo"
end_date <- "yesterday"
twoweek_sessions <- google_analytics(ga_id,
date_range = c("8daysAgo", "yesterday", "16daysAgo", "9daysAgo"),
metrics = "sessions") %>%
rename("This Week" = sessions.d1, "Last Week" = sessions.d2)
twoweek_sessions
new_ret_users <- google_analytics(ga_id,
date_range = c("8daysAgo", "yesterday", "16daysAgo", "9daysAgo"),
metrics = c("sessions"),
dimensions = c("userType")) %>%
rename("This Week" = sessions.d1, "Last Week" = sessions.d2)
new_ret_users$userType <- as.factor(new_ret_users$userType)
new_users <- select(new_ret_users, userType,"This Week")
ret_users <- select(new_ret_users, userType,"Last Week")
head(new_ret_users)
head(new_users)
new_ret_users
new_users
new_ret_users <- google_analytics(ga_id,
date_range = c("8daysAgo", "yesterday", "16daysAgo", "9daysAgo"),
metrics = c("sessions"),
dimensions = c("userType")) %>%
rename("This Week" = sessions.d1, "Last Week" = sessions.d2)
new_ret_users <- as.tbl(new_ret_users)
new_users <- select(new_ret_users, userType,"This Week")
ret_users <- select(new_ret_users, userType,"Last Week")
new_ret_users
new_users
traffic_current_pie <- ggplot(new_users, aes(x="", y = "This Week", fill = userType)) +
geom_bar(width = 1, stat = "identity")
traffic_current_pie
twoweek_sessions
twoweek_sessions
twoweek_sessions %>%
ggplot(aes(x = c("This Week", "Last Week"), y = ..count..)) +
geom_bar()
twoweek_sessions
twoWeekSesh <- ggplot(twoweek_sessions, aes(x = c("This Week", "Last Week"))) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1, position = "fill")
twoWeekSesh <- ggplot(twoweek_sessions, aes(x = c("This Week", "Last Week"))) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1, position = "fill")
twoWeekSesh
install.packages("quantmod")
library(quantmod)
?quantmod
new_ret_users
new_users
slices <- new_ret_users$`This Week`
lbls <- new_ret_users$userType
pct <- round(slices/sum(slices)*100)
lbls <- paste(lbls, pct)
lbls <- paste(lbls, "%", sep="")
pie(slices,labels = lbls, col=rainbow(length(lbls)),
main="All Visitors")
slices <- new_ret_users$`This Week`
lbls <- new_ret_users$userType
pct <- round(slices/sum(slices)*100)
lbls <- paste(lbls, pct)
lbls <- paste(lbls, "%", sep="")
pie(slices,labels = lbls, col=rainbow(length(lbls)),
main="All Visitors")
slices <- new_ret_users$`This Week`
lbls <- new_ret_users$userType
pct <- round(slices/sum(slices)*100)
lbls <- paste(lbls, pct)
lbls <- paste(lbls, "%", sep="")
pie(slices,labels = lbls, col=rainbow(length(lbls)),
main="Visitors:This Week")
rm(twoWeekSesh)
users_thisweek_pie <- new_ret_users %>%
ggplot(aes(x="", y = `This Week`, fill = userType)) +
geom_bar(width = 1, stat = "identity")
users_thisweek_pie
users_thisweek_pie <- new_ret_users %>%
ggplot(aes(x="", y = "This Week", fill = userType)) +
geom_bar(width = 1, stat = "identity")
users_thisweek_pie
users_thisweek_pie <- new_ret_users %>%
ggplot(aes(x="", y = 'This Week', fill = userType)) +
geom_bar(width = 1, stat = "identity")
users_thisweek_pie
users_thisweek_pie <- new_ret_users %>%
ggplot(aes(x="", y = `This Week`, fill = userType)) +
geom_bar(width = 1, stat = "identity")
users_thisweek_pie
users_thisweek_pie <- new_ret_users %>%
ggplot(aes(x="", y = `This Week`, fill = userType)) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0)
users_thisweek_pie
rm(new_ret_users)
rm(new_users)
pie <- new_ret_users %>%
ggplot(aes(x="", y = `This Week`, fill = userType)) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0)
rm(ret_users)
new_ret_users <- google_analytics(ga_id,
date_range = c("8daysAgo", "yesterday", "16daysAgo", "9daysAgo"),
metrics = c("sessions"),
dimensions = c("userType")) %>%
rename("This Week" = sessions.d1, "Last Week" = sessions.d2)
new_ret_users <- as.tbl(new_ret_users)
pie <- new_ret_users %>%
ggplot(aes(x="", y = `This Week`, fill = userType)) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0)
users_thisweek_pie <- pie + scale_fill_brewer("Blues") + blank_theme
library(scales)
pie <- new_ret_users %>%
ggplot(aes(x="", y = `This Week`, fill = userType)) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0)
users_thisweek_pie <- pie + scale_fill_brewer("Blues") + blank_theme +
theme(axis.title.x = element_blank()) +
geom_text(aes(y = value/2 + c(0, cumsum(`This Week`)[-length(`This Week`)]),
label = percent(`This Week`/100)), size = 5)
?scales
knitr::opts_chunk$set(echo = TRUE)
Packages <- c("googleAuthR", "googleAnalyticsR", "tidyverse", "scales")
lapply(Packages, library, character.only = TRUE)
ga_auth(".ga-httr-oauth")
knitr::opts_chunk$set(echo = TRUE)
Packages <- c("googleAuthR", "googleAnalyticsR", "tidyverse", "scales")
lapply(Packages, library, character.only = TRUE)
ga_auth(".ga-httr-oauth")
ga_id <- 158889165
start_date <- "120daysAgo"
end_date <- "yesterday"
twoweek_sessions <- google_analytics(ga_id,
date_range = c("8daysAgo", "yesterday", "16daysAgo", "9daysAgo"),
metrics = "sessions") %>%
rename("This Week" = sessions.d1, "Last Week" = sessions.d2)
twoweek_sessions
new_ret_users <- google_analytics(ga_id,
date_range = c("8daysAgo", "yesterday", "16daysAgo", "9daysAgo"),
metrics = c("sessions"),
dimensions = c("userType")) %>%
rename("This Week" = sessions.d1, "Last Week" = sessions.d2)
new_ret_users <- as.tbl(new_ret_users)
new_ret_users <- google_analytics(ga_id,
date_range = c("8daysAgo", "yesterday", "16daysAgo", "9daysAgo"),
metrics = c("sessions"),
dimensions = c("userType")) %>%
rename("This Week" = sessions.d1, "Last Week" = sessions.d2)
new_ret_users <- as.tbl(new_ret_users)
pie <- new_ret_users %>%
ggplot(aes(x="", y = `This Week`, fill = userType)) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0)
users_thisweek_pie <- pie + scale_fill_brewer("Blues") + blank_theme +
theme(axis.title.x = element_blank()) +
geom_text(aes(y = value/2 + c(0, cumsum(`This Week`)[-length(`This Week`)]),
label = percent(`This Week`/100)), size = 5)
pie <- new_ret_users %>%
ggplot(aes(x="", y = `This Week`, fill = userType)) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0)
users_thisweek_pie <- pie + scale_fill_brewer("Blues") + theme_bw() +
theme(axis.title.x = element_blank()) +
geom_text(aes(y = value/2 + c(0, cumsum(`This Week`)[-length(`This Week`)]),
label = percent(`This Week`/100)), size = 5)
users_thisweek_pie
pie <- new_ret_users %>%
ggplot(aes(x="", y = `This Week`, fill = userType)) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0)
users_thisweek_pie <- pie + scale_fill_brewer("Blues") +
theme(axis.title.x = element_blank()) +
geom_text(aes(y = value/2 + c(0, cumsum(`This Week`)[-length(`This Week`)]),
label = percent(`This Week`/100)), size = 5)
users_thisweek_pie
pie <- new_ret_users %>%
ggplot(aes(x="", y = `This Week`, fill = userType)) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0)
users_thisweek_pie <- pie + scale_fill_brewer("Blues") +
theme(axis.title.x = element_blank()) +
geom_text(aes(y = `This Week`/2 + c(0, cumsum(`This Week`)[-length(`This Week`)]),
label = percent(`This Week`/100)), size = 5)
users_thisweek_pie
?theme_bw
pie <- new_ret_users %>%
ggplot(aes(x="", y = `This Week`, fill = userType)) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0)
users_thisweek_pie <- pie + scale_fill_brewer("Blues") +
theme_bw(axis.title.x = element_blank()) +
geom_text(aes(y = `This Week`/2 + c(0, cumsum(`This Week`)[-length(`This Week`)]),
label = percent(`This Week`/100)), size = 5)
pie <- new_ret_users %>%
ggplot(aes(x="", y = `This Week`, fill = userType)) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0)
users_thisweek_pie <- pie + scale_fill_brewer("Blues") +
theme_bw() +
geom_text(aes(y = `This Week`/2 + c(0, cumsum(`This Week`)[-length(`This Week`)]),
label = percent(`This Week`/100)), size = 5)
users_thisweek_pie
pie <- new_ret_users %>%
ggplot(aes(x="", y = `This Week`, fill = userType)) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0)
users_thisweek_pie <- pie + scale_fill_brewer("Blues") +
theme_bw() +
geom_text(aes(y = `This Week`/3 + c(0, cumsum(`This Week`)[-length(`This Week`)]),
label = percent(`This Week`/100)), size = 5)
users_thisweek_pie
pie <- new_ret_users %>%
ggplot(aes(x="", y = `This Week`, fill = userType)) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0)
users_thisweek_pie <- pie + scale_fill_brewer("Blues") +
theme_bw() +
geom_text(aes(y = `This Week`/4 + c(0, cumsum(`This Week`)[-length(`This Week`)]),
label = percent(`This Week`/100)), size = 5)
users_thisweek_pie
pie <- new_ret_users %>%
ggplot(aes(x="", y = `This Week`, fill = userType)) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0)
users_thisweek_pie <- pie + scale_fill_brewer("Blues") +
theme_bw() +
geom_text(aes(y = `This Week` + c(0, cumsum(`This Week`)[-length(`This Week`)]),
label = percent(`This Week`/100)), size = 5)
users_thisweek_pie
new_ret_users <- google_analytics(ga_id,
date_range = c("8daysAgo", "yesterday", "16daysAgo", "9daysAgo"),
metrics = c("sessions"),
dimensions = c("userType")) %>%
rename("This Week" = sessions.d1, "Last Week" = sessions.d2)
new_ret_users <- as.tbl(new_ret_users)
new_ret_users
pie <- new_ret_users %>%
ggplot(aes(x="", y = `This Week`, fill = userType)) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0)
users_thisweek_pie <- pie +
theme_bw() +
geom_text(aes(y = `This Week` + c(0, cumsum(`This Week`)[-length(`This Week`)]),
label = percent(`This Week`/100)), size = 5)
users_thisweek_pie
pie <- new_ret_users %>%
ggplot(aes(x="", y = `This Week`, fill = userType)) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0)
users_thisweek_pie <- pie + scale_fill_brewer("Blues") +
theme_bw() +
geom_text(aes(y = sum(`This Week`) + cumsum(`This Week`)[-length(`This Week`)]),
label = percent(`This Week`/100), size = 5)
df <- as.data.frame(table(mpg$class))
colnames(df) <- c("class", "freq")
pie <- ggplot(df, aes(x = "", y=freq, fill = factor(class))) +
geom_bar(width = 1, stat = "identity") +
theme(axis.line = element_blank(),
plot.title = element_text(hjust=0.5)) +
labs(fill="class",
x=NULL,
y=NULL,
title="Pie Chart of class",
caption="Source: mpg")
pie + coord_polar(theta = "y", start=0)
pie <- ggplot(mpg, aes(x = "", fill = factor(class))) +
geom_bar(width = 1) +
theme(axis.line = element_blank(),
plot.title = element_text(hjust=0.5)) +
labs(fill="class",
x=NULL,
y=NULL,
title="Pie Chart of class",
caption="Source: mpg")
pie + coord_polar(theta = "y", start=0)
users_thisweek <- new_ret_users %>%
ggplot(aes(x="", y = `This Week`, fill = userType)) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0) +
scale_fill_brewer("Blues")
users_thisweek_pie
users_thisweek_pie
users_thisweek <- new_ret_users %>%
ggplot(aes(x="", y = `This Week`, fill = userType)) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0) +
scale_fill_brewer("Blues")
users_thisweek
users_thisweek
users_thisweek <- new_ret_users %>%
ggplot(aes(x="", y = `This Week`, fill = userType)) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0) +
scale_fill_brewer("Blues") +
labs(x="", y="", title = "Visitors: This Week \n", fill = "User Type") +
theme(plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5, face = "bold", size = 10))
users_thisweek
users_thisweek
users_thisweek <- new_ret_users %>%
ggplot(aes(x="", y = `This Week`, fill = userType)) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0) +
scale_fill_brewer("Blues") +
labs(x="", y="", title = "Visitors: This Week", fill = "User Type") +
theme(plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5, face = "bold", size = 10))
users_thisweek
users_thisweek
users_thisweek <- new_ret_users %>%
ggplot(aes(x="", y = `This Week`, fill = userType)) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0) +
scale_fill_brewer("Bluegs") +
labs(x="", y="", title = "Visitors: This Week \n", fill = "User Type") +
theme(plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5, face = "bold", size = 10))
users_thisweek
users_thisweek
users_thisweek <- new_ret_users %>%
ggplot(aes(x="", y = `This Week`, fill = userType)) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0) +
scale_fill_brewer("Bluegs") +
labs(x="", y="", title = "Visitors: This Week \n") +
theme(plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5, face = "bold", size = 10))
users_thisweek
users_thisweek
knitr::opts_chunk$set(echo = TRUE)
Packages <- c("googleAuthR", "googleAnalyticsR", "tidyverse", "scales")
lapply(Packages, library, character.only = TRUE)
ga_auth(".ga-httr-oauth")
twoweek_sessions <- google_analytics(ga_id,
date_range = c("8daysAgo", "yesterday", "16daysAgo", "9daysAgo"),
metrics = "sessions") %>%
rename("This Week" = sessions.d1, "Last Week" = sessions.d2)
knitr::opts_chunk$set(echo = TRUE)
Packages <- c("googleAuthR", "googleAnalyticsR", "tidyverse", "scales")
lapply(Packages, library, character.only = TRUE)
ga_auth(".ga-httr-oauth")
ga_id <- 158889165
start_date <- "120daysAgo"
end_date <- "yesterday"
twoweek_sessions <- google_analytics(ga_id,
date_range = c("8daysAgo", "yesterday", "16daysAgo", "9daysAgo"),
metrics = "sessions") %>%
rename("This Week" = sessions.d1, "Last Week" = sessions.d2)
twoweek_sessions
?met_filter
dimension_filter <- dim_filter("pagePath","EXACT","vmc-aws-tco-pricing",not = TRUE)
pagePath_filter <- filter_clause_ga4(list(dimension_filter))
tco_table <- google_analytics(ga_id,
date_range = c("8daysAgo", "yesterday", "16daysAgo", "9daysAgo"),
metrics = c("pageviews", "uniquePageviews", "avgTimeOnPage", "entrances","bounceRate", "exitRate"),
dimensions = c("pagePath"),
dim_filters = pagePath_filter,
anti_sample = TRUE)
dimension_filter <- dim_filter("pagePath","EXACT","vmc-aws-tco-pricing",not = TRUE)
pagePath_filter <- filter_clause_ga4(list(dimension_filter))
tco_table <- google_analytics(ga_id,
date_range = c("8daysAgo", "yesterday", "16daysAgo", "9daysAgo"),
metrics = c("pageviews", "uniquePageviews", "avgTimeOnPage", "entrances","bounceRate", "exitRate"),
dimensions = c("pagePath"),
dim_filters = pagePath_filter)
tco_table
dim
dimension_filter <- dim_filter("pagePath","PARTIAL","vmc-aws-tco-pricing",not = TRUE)
pagePath_filter <- filter_clause_ga4(list(dimension_filter))
tco_table <- google_analytics(ga_id,
date_range = c("8daysAgo", "yesterday", "16daysAgo", "9daysAgo"),
metrics = c("pageviews", "uniquePageviews", "avgTimeOnPage", "entrances","bounceRate", "exitRate"),
dimensions = c("pagePath"),
dim_filters = pagePath_filter)
tco_table
dimension_filter <- dim_filter("pagePath","PARTIAL","vmc-aws-tco-pricing",not = TRUE)
pagePath_filter <- filter_clause_ga4(list(dimension_filter))
tco_table <- google_analytics(ga_id,
date_range = c("8daysAgo", "yesterday", "16daysAgo", "9daysAgo"),
dimensions = c("pagePath"),
dim_filters = pagePath_filter),
dimension_filter <- dim_filter("pagePath","PARTIAL","vmc-aws-tco-pricing",not = TRUE)
pagePath_filter <- filter_clause_ga4(list(dimension_filter))
tco_table <- google_analytics(ga_id,
date_range = c("8daysAgo", "yesterday", "16daysAgo", "9daysAgo"),
dimensions = c("pagePath"),
dim_filters = pagePath_filter,
metrics = c("pageviews", "uniquePageviews", "avgTimeOnPage", "entrances","bounceRate", "exitRate"))
dimension_filter <- dim_filter("pagePath","PARTIAL","vmc-aws-tco-pricing",not = FALSE)
pagePath_filter <- filter_clause_ga4(list(dimension_filter))
tco_table <- google_analytics(ga_id,
date_range = c("8daysAgo", "yesterday", "16daysAgo", "9daysAgo"),
dimensions = c("pagePath"),
dim_filters = pagePath_filter,
metrics = c("pageviews", "uniquePageviews", "avgTimeOnPage", "entrances","bounceRate", "exitRate"))
tco_table
dimension_filter <- dim_filter("pagePath","PARTIAL","vmc-aws-tco-pricing",not = FALSE)
pagePath_filter <- filter_clause_ga4(list(dimension_filter))
tco_table <- google_analytics(ga_id,
date_range = c("8daysAgo", "yesterday", "365daysAgo", "9daysAgo"),
dimensions = c("pagePath"),
dim_filters = pagePath_filter,
metrics = c("pageviews", "uniquePageviews", "avgTimeOnPage", "entrances","bounceRate", "exitRate"))
tco_table
common_tops <- top20_pv_delta_wow %>% inner_join(top20_lp_delta_wow) %>%
rename("Common Pages" = pagePath) %>%
select("Common Pages")
common_tops <- top20_pv_delta_wow %>% inner_join(top20_lp_delta_wow) %>%
rename("Common Pages" = "pagePath") %>%
select("Common Pages")
tco_dates <- google_analytics(ga_id,
dimensions = c("pagePath", "date", "dateHour", "dateHourMinute"),
dim_filters = pagePath_filter,
metrics = c("pageviews", "uniquePageviews", "avgTimeOnPage", "entrances","bounceRate", "exitRate"))
tco_dates <- google_analytics(ga_id,
date_range = c("365daysAgo", "yesterday"),
dimensions = c("pagePath", "date", "dateHour", "dateHourMinute"),
dim_filters = pagePath_filter,
metrics = c("pageviews", "uniquePageviews", "avgTimeOnPage", "entrances","bounceRate", "exitRate"))
tco_dates
print(g)
# Code copied from ggplot2 case study. Edited slightly for usability.
Packages <- c("dplyr", "ggplot2", "reshape2", "ggthemes", "carData")
lapply(Packages, library, character.only = TRUE)
mosaicGG <- function(data, X, FILL) {
# Proportions in raw data
DF <- as.data.frame.matrix(table(data[[X]], data[[FILL]]))
DF$groupSum <- rowSums(DF)
DF$xmax <- cumsum(DF$groupSum)
DF$xmin <- DF$xmax - DF$groupSum
DF$X <- row.names(DF)
DF$groupSum <- NULL
DF_melted <- melt(DF, id = c("X", "xmin", "xmax"), variable.name = "FILL")
DF_melted <- DF_melted %>%
group_by(X) %>%
mutate(ymax = cumsum(value/sum(value)),
ymin = ymax - value/sum(value))
# Chi-sq test
results <- chisq.test(table(data[[FILL]], data[[X]])) # fill and then x
resid <- melt(results$residuals)
names(resid) <- c("FILL", "X", "residual")
# Merge data
DF_all <- merge(DF_melted, resid)
# Positions for labels
DF_all$xposn <- DF_all$xmin + (DF_all$xmax - DF_all$xmin)/2
index <- DF_all$xmax == max(DF_all$xmax)
DF_all$yposn <- DF_all$ymin[index] + (DF_all$ymax[index] - DF_all$ymin[index])/2
# Plot
g <- ggplot(DF_all, aes(ymin = ymin,  ymax = ymax, xmin = xmin,
xmax = xmax, fill = residual)) +
geom_rect(col = "white") +
geom_text(aes(x = xposn, label = X),
y = 1, size = 3, angle = 90, hjust = 1, show.legend = FALSE) +
geom_text(aes(x = max(xmax),  y = yposn, label = FILL),
size = 3, hjust = 1, show.legend = FALSE) +
scale_fill_gradient2("Residuals") +
scale_x_continuous("Individuals", expand = c(0,0)) +
scale_y_continuous("Proportion", expand = c(0,0)) +
theme_tufte() +
theme(legend.position = "bottom")
print(g)
}
mosaicGG(adult, X = "SRAGE_P", FILL = "RBMI")
# Poverty described by age
mosaicGG(adult, X = "SRAGE_P", FILL = "POVLL")
# mtcars: am described by cyl
mosaicGG(mtcars, "cyl", "am")
# Vocab: vocabulary described by educational
mosaicGG(Vocab, "education", "vocabulary")
source('C:/Users/v-kursan/Downloads/Capstone_DS/Data/InitialVisualization_Capstone.R')
install.packages("ROCR")
library(ROCR)
library(caTools)
